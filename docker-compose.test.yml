services:
#Test Database
  db:
    image: mariadb:11.4
    command: --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci
    environment:
      - MARIADB_ROOT_PASSWORD=test_root_password
      - MARIADB_DATABASE=tatou_test
      - MARIADB_USER=tatou_test
      - MARIADB_PASSWORD=test_password
    volumes:
      - test-db-data:/var/lib/mysql
      - ./db/tatou_test.sql:/docker-entrypoint-initdb.d/10-tatou_test.sql:ro
    healthcheck:
      test: ["CMD-SHELL", "mariadb-admin ping -h 127.0.0.1 -u root --password=test_root_password --silent"]
      interval: 10s
      timeout: 5s
      retries: 5
      start_period: 10s
    ports:
      - "3307:3306"
    restart: unless-stopped

networks:
  test-network:
    driver: bridge

volumes:
  test-db-data:

